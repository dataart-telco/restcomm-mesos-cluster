series: trusty 
services:
  zookeeper:
    charm: cs:~dataart-telco-practice/trusty/mesos-zookeeper-1
    num_units: 1
    expose: true
    annotations:
      gui-x: "1440"
      gui-y: "720"
    to:
      - "30"
  mesos-master:
    charm: cs:~dataart-telco-practice/trusty/mesos-master-4
    num_units: 1
    expose: true
    annotations:
      gui-x: "1440"
      gui-y: "1080"
    to:
      - "30"
  mesos-dns:
    charm: cs:~dataart-telco-practice/trusty/mesos-dns-0
    num_units: 1
    expose: true
    annotations:
      gui-x: "1440"
      gui-y: "360"
    to:
      - "30"
  mesos-marathon:
    charm: cs:~dataart-telco-practice/trusty/mesos-marathon-1
    num_units: 1
    expose: true
    annotations:
      gui-x: "1080"
      gui-y: "720"
    to:
      - "30"
  mesos-restcomm:
    charm: cs:~dataart-telco-practice/trusty/mesos-slave-0
    num_units: 1
    constraints: "mem=4G cpu-cores=1 root-disk=8G"
    options:
      segment: restcomm
      override_hostname: true
    annotations:
      gui-x: "1800"
      gui-y: "540"
    to:
      - "32"
  mesos-slave:
    charm: cs:~dataart-telco-practice/trusty/mesos-slave-0
    num_units: 1
    constraints: "mem=4G cpu-cores=4 root-disk=12G"
    options:
      override_hostname: true
    annotations:
      gui-x: "1800"
      gui-y: "900"
    to:
      - "31"
  restcomm:
    charm: cs:~dataart-telco-practice/trusty/restcomm-1
    options:
      sms_proxy: ""
      init_password: "q1w2e3r4t5"
      voicerss_key: "29b2d893df9f454abbfae94df6cff95b"
    annotations:
      gui-x: "360"
      gui-y: "740"
  calls-consumer:
    charm: cs:~dataart-telco-practice/trusty/calls-consumer-1
    options:
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
      PHONE_NUMBER: "5555"
      DID_DOMAIN: ""
    annotations:
      gui-x: "720"
      gui-y: "360"
  conference-call:
    charm: cs:~dataart-telco-practice/trusty/conference-call-1
    options:
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
      DID_DOMAIN: ""
    annotations:
      gui-x: "720"
      gui-y: "600"
  sms-feedback:
    charm: cs:~dataart-telco-practice/trusty/sms-feedback-0
    options:
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
      DID_DOMAIN: ""
    annotations:
      gui-x: "720"
      gui-y: "980"
  ivr-app:
    charm: cs:~dataart-telco-practice/trusty/ivr-app-2
    options:
      PHONE_NUMBER: "7777"
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
    annotations:
      gui-x: "720"
      gui-y: "1200"
  redis-master:
    charm: cs:~mbruzek/trusty/redis-master-0
    num_units: 1
    expose: true
    annotations:
      gui-x: "1080"
      gui-y: "360"
    to:
      - "31"
  haproxy:
    charm: cs:trusty/haproxy-19
    num_units: 1
    expose: true
    options:
      services: "[]"
    annotations:
      gui-x: "1080"
      gui-y: "1080"
    to:
      - "31" 
machines:
  "30":
    series: trusty
    constraints: "arch=amd64 cpu-cores=4 mem=4096"
  "31":
    series: trusty
    constraints: "arch=amd64 cpu-cores=4 mem=4096"
  "32":
    series: trusty
    constraints: "arch=amd64 cpu-cores=2 mem=4096" 
relations:
# mesos cluster
  - - zookeeper
    - mesos-master
  - - zookeeper
    - mesos-marathon
  - - zookeeper
    - mesos-slave
  - - zookeeper
    - mesos-dns
  - - zookeeper
    - mesos-restcomm
  - - mesos-dns:dns-server
    - mesos-slave:dns-server
  - - mesos-dns:dns-server
    - mesos-marathon:dns-server
  - - mesos-dns:dns-server
    - mesos-restcomm:dns-server
# end restcomm to mesos
  - - restcomm
    - mesos-marathon
# callc consumer
  - - calls-consumer:redis
    - redis-master:db
  - - calls-consumer:restcomm
    - restcomm:website
  - - calls-consumer:mesos
    - mesos-marathon:juju-info
  - - haproxy:reverseproxy
    - calls-consumer:haproxy
# end conference
  - - conference-call:redis
    - redis-master:db
  - - conference-call:restcomm
    - restcomm:website
  - - conference-call:mesos
    - mesos-marathon:juju-info
  - - haproxy:reverseproxy
    - conference-call:haproxy
# end sms
  - - sms-feedback:redis
    - redis-master:db
  - - sms-feedback:restcomm
    - restcomm:website
  - - sms-feedback:mesos
    - mesos-marathon:juju-info
  - - haproxy:reverseproxy
    - sms-feedback:haproxy
# end
  - - ivr-app:restcomm
    - restcomm:website
  - - ivr-app:mesos
    - mesos-marathon:juju-info
  - - haproxy:reverseproxy
    - ivr-app:haproxy
